<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head}">
    <title>Ventas - Pink Hazze</title>
</head>
<body class="min-h-screen flex flex-col">
    <div th:replace="~{fragments/layout :: navbar}"></div>

    <main class="flex-1 p-6">
        <div class="container">
            <div class="max-w-4xl mx-auto">
                <!-- Header -->
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h1 class="text-3xl font-bold">Gestión de Ventas</h1>
                        <p style="color: var(--muted-foreground);">Registro y administración de las ventas</p>
                    </div>
                    <a th:href="@{/ventas/nuevo}" class="btn btn-primary">
                        <i class="fa-solid fa-plus icon"></i>
                        Nueva Venta
                    </a>
                </div>

                <!-- Tabla de ventas -->
                <div class="card">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Cliente</th>
                                <th>Productos</th>
                                <th>Total</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="salesTableBody">
                            <tr th:if="${ventas != null and !ventas.isEmpty()}" th:each="venta : ${ventas}">
                                <td th:text="${#temporals.format(venta.fecha, 'dd/MM/yyyy HH:mm')}">01/01/2024 10:00</td>
                                <td>
                                    <div>
                                        <div class="font-semibold" th:text="${venta.cliente.nombre + ' ' + venta.cliente.primerApellido + ' ' + venta.cliente.segundoApellido}">Cliente</div>
                                        <div class="text-sm" style="color: var(--muted-foreground);" th:text="${venta.cliente.email}">email@ejemplo.com</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="text-sm">
                                        <span th:text="${venta.detalles.size()}">0</span> producto(s)
                                    </div>
                                </td>
                                <td>
                                    <div class="font-semibold"
                                         th:text="${totales[venta.id] != null ? ('₡' + totales[venta.id]) : '-'}">-</div>
                                </td>
                                <td>
                                    <span class="px-2 py-1 rounded text-sm bg-green-100 text-green-800">
                                        Completada
                                    </span>
                                </td>
                                <td>
                                    <div class="flex gap-2">
                                        <a th:href="@{'/ventas/editar/' + ${venta.id}}" class="btn btn-outline btn-sm">
                                            <i class="fa-solid fa-pen-to-square icon"></i>
                                        </a>
                                        <a th:href="@{'/ventas/eliminar/' + ${venta.id}}" class="btn btn-outline btn-sm" style="color: #dc2626;" onclick="return confirm('¿Eliminar venta?');">
                                            <i class="fa-solid fa-trash icon"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>

                            <!-- Si no hay ventas -->
                            <tr th:if="${ventas == null or ventas.isEmpty()}">
                                <td colspan="6" class="text-center p-6" style="color: var(--muted-foreground);">
                                    No hay ventas registradas.
                                    <a th:href="@{/ventas/nuevo}" class="btn btn-primary btn-sm mt-2 center">
                                        Registra la primera
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </main>

    <div th:replace="~{fragments/layout :: footer}"></div>
</body>
</html>